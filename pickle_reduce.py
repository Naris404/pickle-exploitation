#Author: Naris404
#Date 29.09.2021
import pickle

class WithoutReduce:
	def __init__(self):
		self.f = open("test.txt")

class WithReduce:
	def __init__(self):
		self._file_name = "test.txt"
	def __reduce__(self):
		return (open, (self._file_name,)) # returning file descriptor

s = pickle.dumps(WithReduce()) # serialization process
#s = pickle.dumps(WithouthReduce()) #throwing exception, see reduce.txt

d = pickle.loads(s) # deserialization process, returning the file descriptor

for i in d: # iterating over a file to prove everything went correct
	print(i.strip())